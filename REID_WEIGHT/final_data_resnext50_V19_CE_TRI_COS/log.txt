[05/27 20:06:05] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:06:06] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:06:06] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:06:06] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:06:06] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:06:06] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:34:51] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:34:52] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:34:52] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:34:52] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:34:52] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:34:52] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:39:45] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:39:45] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:39:45] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:39:45] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:39:45] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:39:45] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:41:18] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:41:18] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:41:18] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:41:18] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:41:18] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:41:18] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:41:38] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:41:38] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:41:38] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:41:38] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:41:38] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:41:38] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:41:56] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:41:56] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:41:56] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:41:56] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:41:56] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:41:56] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:50:54] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:50:55] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:50:55] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:50:55] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 2123
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:50:55] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 2123
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:50:55] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:52:56] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:52:56] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:52:56] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:52:56] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 4967
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:52:56] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 4967
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 64
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:52:56] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
[05/27 20:53:12] fastreid INFO: Rank of current process: 0. World size: 1
[05/27 20:53:13] fastreid INFO: Environment info:
----------------------  -----------------------------------------------------------------------
sys.platform            win32
Python                  3.7.16 (default, Jan 17 2023, 16:06:28) [MSC v.1916 64 bit (AMD64)]
numpy                   1.21.6
fastreid                failed to import
FASTREID_ENV_MODULE     <not set>
PyTorch                 1.11.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torch
PyTorch debug build     False
GPU available           True
GPU 0                   NVIDIA RTX A6000
CUDA_HOME               None
Pillow                  9.5.0
torchvision             0.12.0+cu113 @C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision
torchvision arch flags  C:\Users\ai\.conda\envs\btt\lib\site-packages\torchvision\_C.pyd
cv2                     4.9.0
----------------------  -----------------------------------------------------------------------
PyTorch built with:
  - C++ Version: 199711
  - MSVC 192829337
  - Intel(R) Math Kernel Library Version 2020.0.2 Product Build 20200624 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 2019
  - LAPACK is enabled (usually provided by MKL)
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.2
  - Magma 2.5.4
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=C:/actions-runner/_work/pytorch/pytorch/builder/windows/tmp_bin/sccache-cl.exe, CXX_FLAGS=/DWIN32 /D_WINDOWS /GR /EHsc /w /bigobj -DUSE_PTHREADPOOL -openmp:experimental -IC:/actions-runner/_work/pytorch/pytorch/builder/windows/mkl/include -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOCUPTI -DUSE_FBGEMM -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=OFF, USE_NNPACK=OFF, USE_OPENMP=ON, USE_ROCM=OFF, 

[05/27 20:53:13] fastreid INFO: Command line arguments: Namespace(config_file='fast_reid/configs/AICUP/bagtricks_R50-ibn.yml', dist_url='tcp://127.0.0.1:49153', eval_only=False, machine_rank=0, num_gpus=1, num_machines=1, opts=[], resume=False)
[05/27 20:53:13] fastreid INFO: Contents of args.config_file=fast_reid/configs/AICUP/bagtricks_R50-ibn.yml:
_BASE_: ../Base-bagtricks.yml

INPUT:
  SIZE_TRAIN: [256, 256]
  SIZE_TEST: [256, 256]

  REA:
    ENABLED: True
    PROB: 0.3 

  FLIP:
    ENABLED: True
    PROB: 0.5

  PADDING:
    ENABLED: False

MODEL:
  BACKBONE:
    NAME: build_resnext_backbone
    DEPTH: 50x
    PRETRAIN: False
    PRETRAIN_PATH: ''
    WITH_IBN: True 
    WITH_SE: True  
    WITH_NL: False
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    ATT_DROP_RATE: 0.2

  HEADS:
    NUM_CLASSES: 4967
    NECK_FEAT: before
    CLS_LAYER: Linear #Linear ArcSoftmax
    POOL_LAYER: GeneralizedMeanPoolingP

DATASETS:
  NAMES: ("AICUP",)
  TESTS: ("AICUP",)

SOLVER:
  BIAS_LR_FACTOR: 1.
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  STEPS: [20,40]
  WARMUP_ITERS: 2000
  CHECKPOINT_PERIOD: 1

TEST:
  EVAL_PERIOD: 1000 # We didn't provide eval dataset
  IMS_PER_BATCH: 128

OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS

[05/27 20:53:13] fastreid INFO: Running with full config:
CUDNN_BENCHMARK: True
DATALOADER:
  NUM_INSTANCE: 4
  NUM_WORKERS: 16
  SAMPLER_TRAIN: NaiveIdentitySampler
  SET_WEIGHT: []
DATASETS:
  COMBINEALL: False
  NAMES: ('AICUP',)
  TESTS: ('AICUP',)
INPUT:
  AFFINE:
    ENABLED: False
  AUGMIX:
    ENABLED: False
    PROB: 0.0
  AUTOAUG:
    ENABLED: False
    PROB: 0.0
  CJ:
    BRIGHTNESS: 0.15
    CONTRAST: 0.15
    ENABLED: False
    HUE: 0.1
    PROB: 0.5
    SATURATION: 0.1
  CROP:
    ENABLED: False
    RATIO: [0.75, 1.3333333333333333]
    SCALE: [0.16, 1]
    SIZE: [224, 224]
  FLIP:
    ENABLED: True
    PROB: 0.5
  PADDING:
    ENABLED: False
    MODE: constant
    SIZE: 10
  REA:
    ENABLED: True
    PROB: 0.3
    VALUE: [123.675, 116.28, 103.53]
  RPT:
    ENABLED: False
    PROB: 0.5
  SIZE_TEST: [256, 256]
  SIZE_TRAIN: [256, 256]
KD:
  EMA:
    ENABLED: False
    MOMENTUM: 0.999
  MODEL_CONFIG: []
  MODEL_WEIGHTS: []
MODEL:
  BACKBONE:
    ATT_DROP_RATE: 0.2
    DEPTH: 50x
    DROP_PATH_RATIO: 0.2
    DROP_RATIO: 0.2
    FEAT_DIM: 2048
    LAST_STRIDE: 1
    NAME: build_resnext_backbone
    NORM: BN
    PRETRAIN: False
    PRETRAIN_PATH: 
    SIE_COE: 3.0
    STRIDE_SIZE: (16, 16)
    WITH_IBN: True
    WITH_NL: False
    WITH_SE: True
  DEVICE: cuda
  FREEZE_LAYERS: []
  HEADS:
    CLS_LAYER: Linear
    EMBEDDING_DIM: 512
    MARGIN: 0.0
    NAME: EmbeddingHead
    NECK_FEAT: before
    NORM: BN
    NUM_CLASSES: 4967
    POOL_LAYER: GeneralizedMeanPoolingP
    SCALE: 1
    WITH_BNNECK: True
  LOSSES:
    ARCFACE:
      MARGIN: 0.5
      SCALE: 64.0
    CE:
      ALPHA: 0.2
      EPSILON: 0.1
      SCALE: 1.0
    CIRCLE:
      GAMMA: 128
      MARGIN: 0.25
      SCALE: 1.0
    COMBINED_MARGIN_LOSS:
      M1: 1.0
      M2: 0.75
      M3: 0.0
      SCALE: 64.0
    COSFACE:
      GAMMA: 64
      MARGIN: 0.35
      SCALE: 1.0
    FL:
      ALPHA: 0.25
      GAMMA: 2
      SCALE: 1.0
    NAME: ('CrossEntropyLoss', 'TripletLoss', 'Cosface')
    TRI:
      HARD_MINING: True
      MARGIN: 0.3
      NORM_FEAT: False
      SCALE: 0.5
  META_ARCHITECTURE: Baseline
  PIXEL_MEAN: [123.675, 116.28, 103.53]
  PIXEL_STD: [58.395, 57.120000000000005, 57.375]
  QUEUE_SIZE: 8192
  WEIGHTS: 
OUTPUT_DIR: logs/AICUP_115/V1_night-time_card_detection/final_data_resnext50_V19_CE_TRI_COS
SOLVER:
  AMP:
    ENABLED: True
  BASE_LR: 0.00035
  BIAS_LR_FACTOR: 1.0
  CHECKPOINT_PERIOD: 1
  CLIP_GRADIENTS:
    CLIP_TYPE: norm
    CLIP_VALUE: 5.0
    ENABLED: False
    NORM_TYPE: 2.0
  DELAY_EPOCHS: 0
  ETA_MIN_LR: 1e-07
  FREEZE_ITERS: 0
  GAMMA: 0.1
  HEADS_LR_FACTOR: 1.0
  IMS_PER_BATCH: 128
  MAX_EPOCH: 60
  MOMENTUM: 0.9
  NESTEROV: False
  OPT: Adam
  SCHED: MultiStepLR
  STEPS: [20, 40]
  WARMUP_FACTOR: 0.1
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0005
  WEIGHT_DECAY_BIAS: 0.0005
  WEIGHT_DECAY_NORM: 0.0005
TEST:
  AQE:
    ALPHA: 3.0
    ENABLED: False
    QE_K: 5
    QE_TIME: 1
  EVAL_PERIOD: 1000
  FLIP:
    ENABLED: False
  IMS_PER_BATCH: 128
  METRIC: cosine
  PRECISE_BN:
    DATASET: Market1501
    ENABLED: False
    NUM_ITER: 300
  RERANK:
    ENABLED: False
    K1: 20
    K2: 6
    LAMBDA: 0.3
  ROC:
    ENABLED: False
[05/27 20:53:13] fastreid INFO: Full config saved to C:\Users\ai\Documents\3B012059\car\logs\AICUP_115\V1_night-time_card_detection\final_data_resnext50_V19_CE_TRI_COS\config.yaml
